#!/bin/bash

set -e

mkdir -p test/bundles

# Build the html to load.
./bin/build-test-html active-constraint

for loader in test/indices/*.coffee; do
    name=$(basename $loader | sed 's/\.[^\.]*$//')
    echo bundling $name
    browserify \
        --transform coffeeify \
        --extension ".coffee" \
        --outfile test/bundles/${name}-loader.js \
        --entry $loader &

    # Build the html to load.
    ./bin/build-test-html $name
done
 
wait

echo finished bundling
grunt notify:build
